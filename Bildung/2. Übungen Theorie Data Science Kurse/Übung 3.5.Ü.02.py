import numpy

# 🔹 Разделение входных данных на метки (label) и признаки (data)
label_list = []     # 🟡 Список для хранения меток классов (первая колонка из data)
data_list = []      # 🟢 Список для хранения самих данных (все колонки, кроме первой)

# 🔁 Проход по каждому элементу в исходных данных
for element in data:
    label_list.append(element[0])   # 📌 Первая колонка — метка класса
    data_list.append(element[1:])   # 📌 Остальные значения — сами признаки

# 🧪 Делим данные на обучающую и тестовую выборки
# 🔸 80% на обучение — первые 8000
# 🔸 20% на тест — всё, что после 8000

training_labels = label_list[:8000]   # 🏋️ Метки для обучения
training_data = data_list[:8000]      # 🏋️ Данные для обучения

test_labels = label_list[8000:]       # 🧪 Метки для тестирования
test_data = data_list[8000:]          # 🧪 Данные для тестирования

# ⚙️ Приведение значений данных к диапазону [0.01, 1.0]
# Обычно это нужно для нейросетей (например, сигмоида плохо работает с [0, 255])
# Формула: нормализуем в [0,1] → масштабируем в [0,0.99] → сдвигаем на +0.01

training_data = (numpy.asarray(training_data)/255 * 0.99) + 0.01  # 🔁 нормализация
test_data = (numpy.asarray(test_data)/255 * 0.99) + 0.01          # 🔁 нормализация
