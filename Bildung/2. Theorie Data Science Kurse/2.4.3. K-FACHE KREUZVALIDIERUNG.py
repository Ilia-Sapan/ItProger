# –°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ (MSE) –∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è: –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?
# 1Ô∏è –ß—Ç–æ —Ç–∞–∫–æ–µ MSE (Mean Squared Error)?
# –≠—Ç–æ –º–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –≤ –∑–∞–¥–∞—á–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
# –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
#
# –ü—Ä–æ–±–ª–µ–º–∞ –æ–¥–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏: –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è
# –ï—Å–ª–∏ –º—ã —Ç—Ä–µ–Ω–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö, –æ–Ω–∞ –º–æ–∂–µ—Ç –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏—Ö, –Ω–æ –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–æ–≤—ã—Ö. –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º (overfitting).
#
# üìå –†–µ—à–µ–Ω–∏–µ? ‚Üí –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è!
#
#  –ß—Ç–æ —Ç–∞–∫–æ–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è?
# –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–± —Ä–∞–∑–±–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ —á–∞—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å —É—Å—Ç–æ–π—á–∏–≤–∞.
#
# üîπ –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:
#
# –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ 80% –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ 20% –¥–ª—è —Ç–µ—Å—Ç–∞.
# –¢—Ä–µ–Ω–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å –Ω–∞ 80%, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ 20%.
# –ù–æ! –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –º–∞–ª–æ –∏–ª–∏ –æ–Ω–∏ —Ä–∞–∑–Ω—ã–µ, —Ç–∞–∫–æ–π –º–µ—Ç–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º.
# üìå –õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Üí K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è!
#
#  K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
# –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ K —á–∞—Å—Ç–µ–π (—Ñ–æ–ª–¥–æ–≤) –∏ —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å K —Ä–∞–∑, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.
#
# üìå –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç? (–ø—Ä–∏–º–µ—Ä —Å K=5)
#
# –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ 5 —á–∞—Å—Ç–µ–π.
# –¢—Ä–µ–Ω–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å –Ω–∞ 4 —á–∞—Å—Ç—è—Ö, —Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–π—Å—è.
# –ü–æ–≤—Ç–æ—Ä—è–µ–º 5 —Ä–∞–∑, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –º–µ–Ω—è—è —Ç–µ—Å—Ç–æ–≤—É—é —á–∞—Å—Ç—å.
# –£—Å—Ä–µ–¥–Ω—è–µ–º MSE ‚Üí –ø–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É –º–æ–¥–µ–ª–∏.
# üìå –ü–æ—á–µ–º—É —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ?
# ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ (–µ—Å–ª–∏ –≤ —Ç–µ—Å—Ç–µ –ø–ª–æ—Ö–∏–µ –¥–∞–Ω–Ω—ã–µ ‚Äì —ç—Ç–æ –Ω–µ –∏—Å–ø–æ—Ä—Ç–∏—Ç –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç).
# ‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç —á–µ—Å—Ç–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å (–µ—Å–ª–∏ MSE –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∏–∑–∫–∏–π –≤–æ –≤—Å–µ—Ö —Ñ–æ–ª–¥–∞—Ö ‚Üí –º–æ–¥–µ–ª—å —Å—Ç–∞–±–∏–ª—å–Ω–∞).
# ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö.


# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –∫–æ–¥–∞ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –¥–ª—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –±–∞—Ä–∞
# 1Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫:
import numpy as np  # –ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
import matplotlib.pyplot as plt  # –ú–æ–¥—É–ª—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
from sklearn.model_selection import KFold, cross_val_score  # –ú–µ—Ç–æ–¥—ã –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏
from sklearn.pipeline import make_pipeline  # –î–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞–≥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–¥–∏–Ω –ø–∞–π–ø–ª–∞–π–Ω
from sklearn.preprocessing import PolynomialFeatures  # –î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ
from sklearn.linear_model import LinearRegression  # –ú–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

# 2Ô∏è‚É£ –ó–∞–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
# –ó–¥–µ—Å—å —É –Ω–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –±–∞—Ä–∞ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏.
# 'days' ‚Äì –º–∞—Å—Å–∏–≤, –≥–¥–µ 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫—É, 7 ‚Äì –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—é.
days = np.array([1, 2, 3, 4, 5, 6, 7]).reshape(-1, 1)
# –ú–µ—Ç–æ–¥ reshape(-1, 1) –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–µ–ª–µ–π scikit-learn).
# 'visits' ‚Äì –º–∞—Å—Å–∏–≤, –≥–¥–µ –∑–∞–ø–∏—Å–∞–Ω–æ —á–∏—Å–ª–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è.
visits = np.array([50, 40, 45, 70, 120, 200, 180])

# 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏:
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —Å–∫–æ–ª—å–∫–æ —Ñ–æ–ª–¥–æ–≤ (—Ä–∞–∑–±–∏–µ–Ω–∏–π) –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.
k = 3  # –í—ã–±–∏—Ä–∞–µ–º 3-–∫—Ä–∞—Ç–Ω—É—é –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–º–Ω–æ–≥–æ.
# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç KFold, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ 3 —á–∞—Å—Ç–∏, –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç –∏—Ö (shuffle=True) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ random_state –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.
kf = KFold(n_splits=k, shuffle=True, random_state=42)
# –ó–∞–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–µ–ø–µ–Ω–µ–π –ø–æ–ª–∏–Ω–æ–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ö–æ—Ç–∏–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.
degrees = [1, 2, 3, 4]

# 4Ô∏è‚É£ –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (MSE) –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞:
mse_results = {}

# 5Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥–ª–∞–¥–∫–æ–π –ª–∏–Ω–∏–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:
# np.linspace —Å–æ–∑–¥–∞–µ—Ç 100 —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Ç 1 –¥–æ 7 (–æ—Ç –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –¥–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è).
x_line = np.linspace(1, 7, 100).reshape(-1, 1)
# reshape(-1, 1) –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, —Ç—Ä–µ–±—É–µ–º—ã–π –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

# 6Ô∏è‚É£ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
plt.figure(figsize=(8, 6))  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞
plt.scatter(days, visits, color='red', label='–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ')  # –†–∏—Å—É–µ–º —Ç–æ—á–∫–∏: –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –∏ —á–∏—Å–ª–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π

# 7Ô∏è‚É£ –û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞:
for degree in degrees:
    # –°–æ–∑–¥–∞–µ–º –ø–∞–π–ø–ª–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–≤–∞ —à–∞–≥–∞:
    #  a) PolynomialFeatures(degree) ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –¥–æ–±–∞–≤–ª—è—è —Å—Ç–æ–ª–±—Ü—ã —Å x, x^2, x^3 –∏ —Ç.–¥. –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏.
    #  b) LinearRegression() ‚Äì –æ–±—É—á–∞–µ—Ç –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö.
    model = make_pipeline(PolynomialFeatures(degree), LinearRegression())

    # –û—Ü–µ–Ω–∏–≤–∞–µ–º –º–æ–¥–µ–ª—å —Å –ø–æ–º–æ—â—å—é –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏.
    # cross_val_score –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Ü–µ–Ω–∫—É –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–º –∏–∑ —Ñ–æ–ª–¥–æ–≤, scoring='neg_mean_squared_error' –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ MSE.
    # –ú—ã –±–µ—Ä–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –∏—Ö –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å (-scores) –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—à–∏–±–∫–∏.
    mse_scores = -cross_val_score(model, days, visits, cv=kf, scoring='neg_mean_squared_error')
    # –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ MSE –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ —Å–ª–æ–≤–∞—Ä—å.
    mse_results[degree] = np.mean(mse_scores)

    # –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (–¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞)
    model.fit(days, visits)
    # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è x_line (–≥–ª–∞–¥–∫–∞—è –∫—Ä–∏–≤–∞—è)
    y_pred = model.predict(x_line)

    # –°—Ç—Ä–æ–∏–º –ª–∏–Ω–∏—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
    plt.plot(x_line, y_pred, label=f'–ü–æ–ª–∏–Ω–æ–º {degree}-–π —Å—Ç–µ–ø–µ–Ω–∏')

# 8Ô∏è‚É£ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞:
plt.legend()  # –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–≥–µ–Ω–¥—É –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
plt.title("–ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è: –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å –±–∞—Ä–∞")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä–∞—Ñ–∏–∫–∞
plt.xlabel("–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏")  # –ü–æ–¥–ø–∏—Å—å –æ—Å–∏ X
plt.ylabel("–ß–∏—Å–ª–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π")  # –ü–æ–¥–ø–∏—Å—å –æ—Å–∏ Y
# –ó–∞–¥–∞–µ–º –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –æ—Å–∏ X, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
plt.xticks(range(1, 8), ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"])
plt.grid()  # –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç–∫—É –Ω–∞ –≥—Ä–∞—Ñ–∏–∫
plt.show()  # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≥—Ä–∞—Ñ–∏–∫

# 9Ô∏è‚É£ –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏:
# mse_results ‚Äì —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á ‚Äì —Å—Ç–µ–ø–µ–Ω—å –ø–æ–ª–∏–Ω–æ–º–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äì —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ MSE –ø–æ —Ñ–æ–ª–¥–∞–º.
print("–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è MSE –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞:")
for degree, mse in mse_results.items():
    print(f"–°—Ç–µ–ø–µ–Ω—å {degree}: MSE = {mse:.2f}")


