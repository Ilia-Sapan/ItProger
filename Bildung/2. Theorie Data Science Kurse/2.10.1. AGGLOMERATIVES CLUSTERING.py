# üß† –ß—Ç–æ —Ç–∞–∫–æ–µ Agglomerative Clustering?
# –≠—Ç–æ –º–µ—Ç–æ–¥ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö:
#
# –°–Ω–∞—á–∞–ª–∞ –∫–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä.
#
# –ó–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å–ª–∏–≤–∞—é—Ç—Å—è —Å–∞–º—ã–µ –±–ª–∏–∑–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã.
#
# –í –∫–æ–Ω—Ü–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ (–¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞).
#
# –ú—ã —Å–∞–º–∏ —Ä–µ—à–∞–µ–º, –≥–¥–µ "–æ–±—Ä–µ–∑–∞—Ç—å" –¥–µ—Ä–µ–≤–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω–æ–µ —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
#
# üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —à–∞–≥–∞–º:
# –ù–∞—á–∞–ª–æ
# –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç ‚Äî —ç—Ç–æ —Å–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä.
#
# –†–∞—Å—á—ë—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
# –°—á–∏—Ç–∞–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏.
# –ü–æ–∫–∞ –≤—Å–µ –∫–ª–∞—Å—Ç–µ—Ä—ã ‚Äî –æ–¥–∏–Ω–æ—á–∫–∏, –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.
#
# –°–ª–∏—è–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö
# –ù–∞—Ö–æ–¥–∏–º 2 —Å–∞–º—ã—Ö –±–ª–∏–∑–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö –≤ –æ–¥–∏–Ω.
#
# –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
# –ü–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–æ–≤—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º –∏ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏.
# –í–æ—Ç —Ç—É—Ç –≤—Å—Ç—É–ø–∞—é—Ç –≤ –∏–≥—Ä—É –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–ª–∏—è–Ω–∏—è (linkage methods).
#
# –ü–æ–≤—Ç–æ—Ä—è–µ–º
# –ü–æ–≤—Ç–æ—Ä—è–µ–º —à–∞–≥–∏ 3‚Äì4, –ø–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
#
# üß© –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Å–ª–∏—è–Ω–∏—è (linkage methods):
# –ö–æ–≥–¥–∞ —Å–ª–∏–≤–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä—ã, –≤–∞–∂–Ω–æ –∫–∞–∫ –º—ã —Å—á–∏—Ç–∞–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏. –í–æ—Ç —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:
#
# 1. Single linkage (–æ–¥–∏–Ω–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
# üìè –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –¥–≤—É—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
#
# –°–º–æ—Ç—Ä–∏–º: –∫–∞–∫–∏–µ 2 —Ç–æ—á–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –±–ª–∏–∂–µ –≤—Å–µ–≥–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É
#
# üí° –î–∞—ë—Ç ¬´–≤—ã—Ç—è–Ω—É—Ç—ã–µ¬ª –∫–ª–∞—Å—Ç–µ—Ä—ã ‚Äî —ç—Ñ—Ñ–µ–∫—Ç —Ü–µ–ø–æ—á–∫–∏
#
# 2. Complete linkage (–ø–æ–ª–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
# üìè –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –¥–≤—É—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
#
# –°–º–æ—Ç—Ä–∏–º: –∫–∞–∫–∏–µ 2 —Ç–æ—á–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –¥–∞–ª—å—à–µ –≤—Å–µ–≥–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
#
# üí° –î–∞—ë—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∏ –ø–ª–æ—Ç–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã, –Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º
#
# 3. Average linkage (—Å—Ä–µ–¥–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
# üìè –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –¥–≤—É—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
#
# –ö–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É single –∏ complete
#
# üí° –ë–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
#
# 4. Ward‚Äôs method (–º–µ—Ç–æ–¥ –£–æ—Ä–¥–∞)
# üìâ –°–ª–∏–≤–∞–µ–º —Ç–µ –∫–ª–∞—Å—Ç–µ—Ä—ã, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É —É–≤–µ–ª–∏—á–µ–Ω–∏—é –æ–±—â–µ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏
#
# –°—á–∏—Ç–∞–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –∞ "—Ü–µ–Ω—É" —Å–ª–∏—è–Ω–∏—è
#
# üí° –ß–∞—Å—Ç–æ –¥–∞—ë—Ç —á—ë—Ç–∫–∏–µ, "—à–∞—Ä–æ–æ–±—Ä–∞–∑–Ω—ã–µ" –∫–ª–∞—Å—Ç–µ—Ä—ã (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ k‚Äëmeans)
#
# üìä –ü—Ä–∏–º–µ—Ä:
# –î–æ–ø—É—Å—Ç–∏–º, —É —Ç–µ–±—è –µ—Å—Ç—å 5 —Ç–æ—á–µ–∫ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏.
# Agglomerative Clustering –Ω–∞—á–Ω—ë—Ç —Å 5 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –∑–∞—Ç–µ–º —Å–æ–ª—å—ë—Ç 2 —Å–∞–º—ã—Ö –±–ª–∏–∑–∫–∏—Ö, –ø–æ—Ç–æ–º —Å–Ω–æ–≤–∞ 2‚Ä¶
# –í –∫–æ–Ω—Ü–µ —Ç—ã –ø–æ–ª—É—á–∏—à—å –¥–µ—Ä–µ–≤–æ (–¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—É), –≥–¥–µ –≤–∏–¥–Ω–æ:
# ‚Äî –∫—Ç–æ —Å –∫–µ–º –æ–±—ä–µ–¥–∏–Ω–∏–ª—Å—è,
# ‚Äî –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ,
# ‚Äî –Ω–∞ –∫–∞–∫–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏.
#
# üñº –î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞
# –≠—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏, –≥–¥–µ:
#
# –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ ‚Äî –∫–ª–∞—Å—Ç–µ—Ä—ã (–∏–ª–∏ –æ–±—ä–µ–∫—Ç—ã),
#
# –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏.
#
# –ú–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å –æ–±—Ä–µ–∑–∫–∏ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ ‚Üí –ø–æ–ª—É—á–∏—à—å K –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
#
# üß™ –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:
# –ì–µ–Ω–µ—Ç–∏–∫–∞: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –î–ù–ö-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
#
# –¢–µ–∫—Å—Ç: –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
#
# –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é
#
# –ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –Ω–∞ Python —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã.

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.cluster.hierarchy import dendrogram, linkage

# –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (5 —Ç–æ—á–µ–∫ –≤ 2D)
data = np.array([
    [1, 2],
    [2, 3],
    [5, 8],
    [6, 9],
    [8, 10]
])

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
linked = linkage(data, method='ward')  # –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å: 'single', 'complete', 'average', 'ward'

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã
plt.figure(figsize=(8, 5))
dendrogram(linked,
           orientation='top',
           distance_sort='ascending',
           show_leaf_counts=True)

plt.title('–î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞: Agglomerative Clustering')
plt.xlabel('–ù–æ–º–µ—Ä —Ç–æ—á–∫–∏')
plt.ylabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏')
plt.grid(True)
plt.tight_layout()
plt.show()
